/*
 * Shuffle.js by @Vestride
 * Categorize, sort, and filter a responsive grid of items.
 * Dependencies: jQuery 1.9+, Modernizr 2.6.2+
 * @license MIT license
 * @version 3.1.1
 */
!function(b){"function"==typeof define&&define.amd?define(["jquery","modernizr"],b):"object"==typeof exports?module.exports=b(require("jquery"),window.Modernizr):window.Shuffle=b(window.jQuery,window.Modernizr)}(function(F,H,J){function L(b){return b?b.replace(/([A-Z])/g,function(c,d){return"-"+d.toLowerCase()}).replace(/^ms-/,"-ms-"):""}function N(a,k,l){var m,n,o,p=null,q=0;l=l||{};var r=function(){q=l.leading===!1?0:F.now(),p=null,o=a.apply(m,n),m=n=null};return function(){var b=F.now();q||l.leading!==!1||(q=b);var c=k-(b-q);return m=this,n=arguments,0>=c||c>k?(clearTimeout(p),p=null,q=b,o=a.apply(m,n),m=n=null):p||l.trailing===!1||(p=setTimeout(r,c)),o}}function P(f,g,h){for(var i=0,j=f.length;j>i;i++){if(g.call(h,f[i],i,f)==={}){return}}}function Q(a,e,f){return setTimeout(F.proxy(a,e),f)}function R(b){return Math.max.apply(Math,b)}function S(b){return Math.min.apply(Math,b)}function T(a){return F.isNumeric(a)?a:0}function U(e){var f,g,h=e.length;if(!h){return e}for(;--h;){g=Math.floor(Math.random()*(h+1)),f=e[g],e[g]=e[h],e[h]=f}return e}if("object"!=typeof H){throw new Error("Shuffle.js requires Modernizr.\nhttp://vestride.github.io/Shuffle/#dependencies")}var V=H.prefixed("transition"),W=H.prefixed("transitionDelay"),X=H.prefixed("transitionDuration"),Y={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[V],Z=H.prefixed("transform"),aa=L(Z),ab=H.csstransforms&&H.csstransitions,ac=H.csstransforms3d,ad=!!window.getComputedStyle,ae="shuffle",af="all",ag="groups",ah=1,ai=0.001,aj=window.getComputedStyle||function(){},G=function(c,d){this.x=T(c),this.y=T(d)};G.equals=function(c,d){return c.x===d.x&&c.y===d.y};var I=function(){if(!ad){return !1}var e=document.body||document.documentElement,f=document.createElement("div");f.style.cssText="width:10px;padding:2px;-webkit-box-sizing:border-box;box-sizing:border-box;",e.appendChild(f);var g=aj(f,null).width,h="10px"===g;return e.removeChild(f),h}(),K=0,M=F(window),O=function(a,d){d=d||{},F.extend(this,O.options,d,O.settings),this.$el=F(a),this.element=a,this.unique="shuffle_"+K++,this._fire(O.EventType.LOADING),this._init(),Q(function(){this.initialized=!0,this._fire(O.EventType.DONE)},this,16)};return O.EventType={LOADING:"loading",DONE:"done",LAYOUT:"layout",REMOVED:"removed"},O.ClassName={BASE:ae,SHUFFLE_ITEM:"shuffle-item",FILTERED:"filtered",CONCEALED:"concealed"},O.options={group:af,speed:250,easing:"ease-out",itemSelector:"",sizer:null,gutterWidth:0,columnWidth:0,delimeter:null,buffer:0,columnThreshold:ad?0.01:0.1,initialSort:null,throttle:N,throttleTime:300,sequentialFadeDelay:150,supported:ab},O.settings={useSizer:!1,itemCss:{position:"absolute",top:0,left:0,visibility:"visible"},revealAppendedDelay:300,lastSort:{},lastFilter:af,enabled:!0,destroyed:!1,initialized:!1,_animations:[],_transitions:[],_isMovementCanceled:!1,styleQueue:[]},O.Point=G,O._getItemTransformString=function(c,d){return ac?"translate3d("+c.x+"px, "+c.y+"px, 0) scale3d("+d+", "+d+", 1)":"translate("+c.x+"px, "+c.y+"px) scale("+d+")"},O._getNumberStyle=function(a,f,g){if(ad){g=g||aj(a,null);var h=O._getFloat(g[f]);return I||"width"!==f?I||"height"!==f||(h+=O._getFloat(g.paddingTop)+O._getFloat(g.paddingBottom)+O._getFloat(g.borderTopWidth)+O._getFloat(g.borderBottomWidth)):h+=O._getFloat(g.paddingLeft)+O._getFloat(g.paddingRight)+O._getFloat(g.borderLeftWidth)+O._getFloat(g.borderRightWidth),h}return O._getFloat(F(a).css(f))},O._getFloat=function(b){return T(parseFloat(b))},O._getOuterWidth=function(g,h){var i=aj(g,null),j=O._getNumberStyle(g,"width",i);if(h){var k=O._getNumberStyle(g,"marginLeft",i),l=O._getNumberStyle(g,"marginRight",i);j+=k+l}return j},O._getOuterHeight=function(g,h){var i=aj(g,null),j=O._getNumberStyle(g,"height",i);if(h){var k=O._getNumberStyle(g,"marginTop",i),l=O._getNumberStyle(g,"marginBottom",i);j+=k+l}return j},O._skipTransition=function(f,g,h){var i=f.style[X];f.style[X]="0ms",g.call(h);var j=f.offsetWidth;j=null,f.style[X]=i},O.prototype._init=function(){this.$items=this._getItems(),this.sizer=this._getElementOption(this.sizer),this.sizer&&(this.useSizer=!0),this.$el.addClass(O.ClassName.BASE),this._initItems(),M.on("resize."+ae+"."+this.unique,this._getResizeFunction());var c=this.$el.css(["position","overflow"]),d=O._getOuterWidth(this.element);this._validateStyles(c),this._setColumns(d),this.shuffle(this.group,this.initialSort),this.supported&&Q(function(){this._setTransitions(),this.element.style[V]="height "+this.speed+"ms "+this.easing},this)},O.prototype._getResizeFunction=function(){var a=F.proxy(this._onResize,this);return this.throttle?this.throttle(a,this.throttleTime):a},O.prototype._getElementOption=function(b){return"string"==typeof b?this.$el.find(b)[0]||null:b&&b.nodeType&&1===b.nodeType?b:b&&b.jquery?b[0]:null},O.prototype._validateStyles=function(b){"static"===b.position&&(this.element.style.position="relative"),"hidden"!==b.overflow&&(this.element.style.overflow="hidden")},O.prototype._filter=function(d,e){d=d||this.lastFilter,e=e||this.$items;var f=this._getFilteredSets(d,e);return this._toggleFilterClasses(f.filtered,f.concealed),this.lastFilter=d,"string"==typeof d&&(this.group=d),f.filtered},O.prototype._getFilteredSets=function(a,f){var g=F(),h=F();return a===af?g=f:P(f,function(b){var d=F(b);this._doesPassFilter(a,d)?g=g.add(d):h=h.add(d)},this),{filtered:g,concealed:h}},O.prototype._doesPassFilter=function(a,f){if(F.isFunction(a)){return a.call(f[0],f,this)}var g=f.data(ag),h=this.delimeter&&!F.isArray(g)?g.split(this.delimeter):g;return F.inArray(a,h)>-1},O.prototype._toggleFilterClasses=function(c,d){c.removeClass(O.ClassName.CONCEALED).addClass(O.ClassName.FILTERED),d.removeClass(O.ClassName.FILTERED).addClass(O.ClassName.CONCEALED)},O.prototype._initItems=function(b){b=b||this.$items,b.addClass([O.ClassName.SHUFFLE_ITEM,O.ClassName.FILTERED].join(" ")),b.css(this.itemCss).data("point",new G).data("scale",ah)},O.prototype._updateItemCount=function(){this.visibleItems=this._getFilteredItems().length},O.prototype._setTransition=function(b){b.style[V]=aa+" "+this.speed+"ms "+this.easing+", opacity "+this.speed+"ms "+this.easing},O.prototype._setTransitions=function(b){b=b||this.$items,P(b,function(c){this._setTransition(c)},this)},O.prototype._setSequentialDelay=function(b){this.supported&&P(b,function(c,d){c.style[W]="0ms,"+(d+1)*this.sequentialFadeDelay+"ms"},this)},O.prototype._getItems=function(){return this.$el.children(this.itemSelector)},O.prototype._getFilteredItems=function(){return this.$items.filter("."+O.ClassName.FILTERED)},O.prototype._getConcealedItems=function(){return this.$items.filter("."+O.ClassName.CONCEALED)},O.prototype._getColumnSize=function(a,e){var f;return f=F.isFunction(this.columnWidth)?this.columnWidth(a):this.useSizer?O._getOuterWidth(this.sizer):this.columnWidth?this.columnWidth:this.$items.length>0?O._getOuterWidth(this.$items[0],!0):a,0===f&&(f=a),f+e},O.prototype._getGutterSize=function(a){var d;return d=F.isFunction(this.gutterWidth)?this.gutterWidth(a):this.useSizer?O._getNumberStyle(this.sizer,"marginLeft"):this.gutterWidth},O.prototype._setColumns=function(f){var g=f||O._getOuterWidth(this.element),h=this._getGutterSize(g),i=this._getColumnSize(g,h),j=(g+h)/i;Math.abs(Math.round(j)-j)<this.columnThreshold&&(j=Math.round(j)),this.cols=Math.max(Math.floor(j),1),this.containerWidth=g,this.colWidth=i},O.prototype._setContainerSize=function(){this.$el.css("height",this._getContainerSize())},O.prototype._getContainerSize=function(){return R(this.positions)},O.prototype._fire=function(c,d){this.$el.trigger(c+"."+ae,d&&d.length?d:[this])},O.prototype._resetCols=function(){var b=this.cols;for(this.positions=[];b--;){this.positions.push(0)}},O.prototype._layout=function(c,d){P(c,function(b){this._layoutItem(b,!!d)},this),this._processStyleQueue(),this._setContainerSize()},O.prototype._layoutItem=function(a,j){var k=F(a),l=k.data(),m=l.point,n=l.scale,o={width:O._getOuterWidth(a,!0),height:O._getOuterHeight(a,!0)},p=this._getItemPosition(o);G.equals(m,p)&&n===ah||(l.point=p,l.scale=ah,this.styleQueue.push({$item:k,point:p,scale:ah,opacity:j?0:1,skipTransition:j||0===this.speed,callfront:function(){j||k.css("visibility","visible")},callback:function(){j&&k.css("visibility","hidden")}}))},O.prototype._getItemPosition=function(i){for(var j=this._getColumnSpan(i.width,this.colWidth,this.cols),k=this._getColumnSet(j,this.cols),l=this._getShortColumn(k,this.buffer),m=new G(Math.round(this.colWidth*l),Math.round(k[l])),n=k[l]+i.height,o=this.cols+1-k.length,p=0;o>p;p++){this.positions[l+p]=n}return m},O.prototype._getColumnSpan=function(e,f,g){var h=e/f;return Math.abs(Math.round(h)-h)<this.columnThreshold&&(h=Math.round(h)),Math.min(Math.ceil(h),g)},O.prototype._getColumnSet=function(f,g){if(1===f){return this.positions}for(var h=g+1-f,i=[],j=0;h>j;j++){i[j]=R(this.positions.slice(j,j+f))}return i},O.prototype._getShortColumn=function(f,g){for(var h=S(f),i=0,j=f.length;j>i;i++){if(f[i]>=h-g&&f[i]<=h+g){return i}}return 0},O.prototype._shrink=function(a){var d=a||this._getConcealedItems();P(d,function(e){var f=F(e),g=f.data();g.scale!==ai&&(g.scale=ai,this.styleQueue.push({$item:f,point:g.point,scale:ai,opacity:0,callback:function(){f.css("visibility","hidden")}}))},this)},O.prototype._onResize=function(){if(this.enabled&&!this.destroyed){var b=O._getOuterWidth(this.element);b!==this.containerWidth&&this.update()}},O.prototype._getStylesForTransition=function(c){var d={opacity:c.opacity};return this.supported?d[Z]=O._getItemTransformString(c.point,c.scale):(d.left=c.point.x,d.top=c.point.y),d},O.prototype._transition=function(a){var d=this._getStylesForTransition(a);this._startItemAnimation(a.$item,d,a.callfront||F.noop,a.callback||F.noop)},O.prototype._startItemAnimation=function(a,j,k,l){function m(c){c.target===c.currentTarget&&(F(c.target).off(Y,m),n._removeTransitionReference(o),l())}var n=this,o={$element:a,handler:m};if(k(),!this.initialized){return a.css(j),void l()}if(this.supported){a.css(j),a.on(Y,m),this._transitions.push(o)}else{var p=a.stop(!0).animate(j,this.speed,"swing",l);this._animations.push(p.promise())}},O.prototype._processStyleQueue=function(a){this.isTransitioning&&this._cancelMovement();var d=F();P(this.styleQueue,function(b){b.skipTransition?this._styleImmediately(b):(d=d.add(b.$item),this._transition(b))},this),d.length>0&&this.initialized&&this.speed>0?(this.isTransitioning=!0,this.supported?this._whenCollectionDone(d,Y,this._movementFinished):this._whenAnimationsDone(this._movementFinished)):a||Q(this._layoutEnd,this),this.styleQueue.length=0},O.prototype._cancelMovement=function(){this.supported?P(this._transitions,function(b){b.$element.off(Y,b.handler)}):(this._isMovementCanceled=!0,this.$items.stop(!0),this._isMovementCanceled=!1),this._transitions.length=0,this.isTransitioning=!1},O.prototype._removeTransitionReference=function(a){var d=F.inArray(a,this._transitions);d>-1&&this._transitions.splice(d,1)},O.prototype._styleImmediately=function(b){O._skipTransition(b.$item[0],function(){b.$item.css(this._getStylesForTransition(b))},this)},O.prototype._movementFinished=function(){this.isTransitioning=!1,this._layoutEnd()},O.prototype._layoutEnd=function(){this._fire(O.EventType.LAYOUT)},O.prototype._addItems=function(d,e,f){this._initItems(d),this._setTransitions(d),this.$items=this._getItems(),this._shrink(d),P(this.styleQueue,function(b){b.skipTransition=!0}),this._processStyleQueue(!0),e?this._addItemsToEnd(d,f):this.shuffle(this.lastFilter)},O.prototype._addItemsToEnd=function(e,f){var g=this._filter(null,e),h=g.get();this._updateItemCount(),this._layout(h,!0),f&&this.supported&&this._setSequentialDelay(h),this._revealAppended(h)},O.prototype._revealAppended=function(a){Q(function(){P(a,function(d){var e=F(d);this._transition({$item:e,opacity:1,point:e.data("point"),scale:ah})},this),this._whenCollectionDone(F(a),Y,function(){F(a).css(W,"0ms"),this._movementFinished()})},this,this.revealAppendedDelay)},O.prototype._whenCollectionDone=function(a,j,k){function l(c){c.target===c.currentTarget&&(F(c.target).off(j,l),m++,m===n&&(o._removeTransitionReference(p),k.call(o)))}var m=0,n=a.length,o=this,p={$element:a,handler:l};a.on(j,l),this._transitions.push(p)},O.prototype._whenAnimationsDone=function(a){F.when.apply(null,this._animations).always(F.proxy(function(){this._animations.length=0,this._isMovementCanceled||a.call(this)},this))},O.prototype.shuffle=function(c,d){this.enabled&&(c||(c=af),this._filter(c),this._updateItemCount(),this._shrink(),this.sort(d))},O.prototype.sort=function(d){if(this.enabled){this._resetCols();var e=d||this.lastSort,f=this._getFilteredItems().sorted(e);this._layout(f),this.lastSort=e}},O.prototype.update=function(b){this.enabled&&(b||this._setColumns(),this.sort())},O.prototype.layout=function(){this.update(!0)},O.prototype.appended=function(d,e,f){this._addItems(d,e===!0,f!==!1)},O.prototype.disable=function(){this.enabled=!1},O.prototype.enable=function(b){this.enabled=!0,b!==!1&&this.update()},O.prototype.remove=function(a){function d(){a.remove(),this.$items=this._getItems(),this._updateItemCount(),this._fire(O.EventType.REMOVED,[a,this]),a=null}a.length&&a.jquery&&(this._toggleFilterClasses(F(),a),this._shrink(a),this.sort(),this.$el.one(O.EventType.LAYOUT+"."+ae,F.proxy(d,this)))},O.prototype.destroy=function(){M.off("."+this.unique),this.$el.removeClass(ae).removeAttr("style").removeData(ae),this.$items.removeAttr("style").removeData("point").removeData("scale").removeClass([O.ClassName.CONCEALED,O.ClassName.FILTERED,O.ClassName.SHUFFLE_ITEM].join(" ")),this.$items=null,this.$el=null,this.sizer=null,this.element=null,this._transitions=null,this.destroyed=!0},F.fn.shuffle=function(a){var d=Array.prototype.slice.call(arguments,1);return this.each(function(){var b=F(this),c=b.data(ae);c?"string"==typeof a&&c[a]&&c[a].apply(c,d):(c=new O(this,a),b.data(ae,c))})},F.fn.sorted=function(a){var c=F.extend({},F.fn.sorted.defaults,a),g=this.get(),h=!1;return g.length?c.randomize?U(g):(F.isFunction(c.by)&&g.sort(function(d,f){if(h){return 0}var i=c.by(F(d)),j=c.by(F(f));return i===J&&j===J?(h=!0,0):j>i||"sortFirst"===i||"sortLast"===j?-1:i>j||"sortLast"===i||"sortFirst"===j?1:0}),h?this.get():(c.reverse&&g.reverse(),g)):[]},F.fn.sorted.defaults={reverse:!1,by:null,randomize:!1},O});